var bitcore = require('bitcore-lib');
var async = require('async');
var InsightService_1 = require("../Services/InsightService");
var PublicWallet = (function () {
    function PublicWallet(publicKey) {
        this.insightService = new InsightService_1.InsightService('https://insight.bitpay.com/api/');
        this.transactions = [];
        this.changeAddresses = [];
        this.externalAddresses = [];
        this.lastUpdated = new Date();
        this.hdPublicKey = new bitcore.HDPublicKey(publicKey);
    }
    Object.defineProperty(PublicWallet.prototype, "balance", {
        get: function () {
            var changeBalance = 0;
            var externalBalance = 0;
            if (this.changeAddresses.length > 0) {
                changeBalance = this.changeAddresses.map(function (addr) { return addr.balanceSat; }).reduce(function (p, c) { return c + p; });
            }
            if (this.externalAddresses.length > 0) {
                externalBalance = this.externalAddresses.map(function (addr) { return addr.balanceSat; }).reduce(function (p, c) { return c + p; });
            }
            return changeBalance + externalBalance;
        },
        enumerable: true,
        configurable: true
    });
    PublicWallet.prototype.getAddress = function (index, change) {
        var chain = change ? 1 : 0;
        return new bitcore.Address(this.hdPublicKey.derive(chain).derive(index).publicKey);
    };
    PublicWallet.prototype.getAddressRange = function (start, end, change) {
        var addresses = [];
        for (var i = start; i <= end; i++) {
            addresses.push(this.getAddress(i, change).toString());
        }
        return addresses;
    };
    PublicWallet.prototype.getAddressInfo = function (index, change, callback) {
        var address = this.getAddress(index, change).toString();
        this.insightService.getAddressInfo(address, function (err, resp, body) {
            if (err) {
                return callback(err, null);
            }
            return callback(null, JSON.parse(body));
        });
    };
    PublicWallet.prototype.getTransactions = function (change, callback) {
        var startingAddress = 0;
        var addrs = this.getAddressRange(startingAddress, startingAddress + 19, change);
        var self = this;
        function combine(err, resp, body) {
            if (err) {
                return callback(err, null);
            }
            var transactions = JSON.parse(body).items;
            if (transactions.length > 0) {
                transactions.forEach(function (utxo) { return self.transactions.push(utxo); });
                startingAddress += 20;
                addrs = self.getAddressRange(startingAddress, startingAddress + 19, change);
                self.insightService.getTransactions(addrs, combine);
            }
            else {
                callback(err, transactions);
            }
        }
        this.insightService.getTransactions(addrs, combine);
    };
    PublicWallet.prototype.getAddresses = function (change, callback) {
        var _this = this;
        var maxConcurrency = 3;
        var maxUnusedAddresses = 5;
        var index = 0;
        var emptyAddressCount = 0;
        var addresses = [];
        var errors = [];
        function taskCallback(error) {
            if (error) {
                return errors.push(error);
            }
        }
        var q = async.queue(function (task, callback) {
            _this.getAddressInfo(task.index, change, function (err, address) {
                if (err) {
                    return callback(err);
                }
                if (address.txApperances == 0) {
                    emptyAddressCount++;
                }
                else {
                    addresses[task.index] = address;
                }
                if (emptyAddressCount < maxUnusedAddresses) {
                    q.push({ index: index }, taskCallback);
                }
                index++;
                return callback();
            });
        }, maxConcurrency);
        for (index = 0; index < maxConcurrency; index++) {
            q.push({ index: index }, taskCallback);
        }
        q.drain = function () {
            callback(errors.length > 0 ? errors : null, addresses);
        };
    };
    PublicWallet.prototype.update = function (callback) {
        var _this = this;
        async.series([
            function (cb) { return _this.getAddresses(false, cb); },
            function (cb) { return _this.getAddresses(true, cb); },
        ], function (err, results) {
            if (err) {
                return callback(err, null);
            }
            _this.externalAddresses = results[0];
            _this.changeAddresses = results[1];
            callback(null, _this);
        });
    };
    PublicWallet.prototype.createTransaction = function (to, amount, callback) {
        var addrs = [];
        var total = 0;
        this.externalAddresses.filter(function (addr) { return addr.balanceSat > 0; }).forEach(function (addr) {
            if (total < amount) {
                addrs.push(addr.addrStr);
                total += addr.balanceSat;
            }
        });
        this.insightService.getUtxos(addrs, function (err, utxos) {
            if (err) {
                return callback(err, null);
            }
            var utxosForTransaction = utxos.map(function (utxo) {
                return {
                    address: utxo.address,
                    txId: utxo.txid,
                    outputIndex: utxo.vout,
                    script: utxo.scriptPubKey,
                    satoshis: utxo.satoshis
                };
            });
            var transaction = new bitcore.Transaction()
                .from(utxosForTransaction)
                .to(to, amount);
            return callback(null, transaction);
        });
    };
    return PublicWallet;
})();
exports.PublicWallet = PublicWallet;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUHVibGljV2FsbGV0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL01vZGVscy9QdWJsaWNXYWxsZXQudHMiXSwibmFtZXMiOlsiUHVibGljV2FsbGV0IiwiUHVibGljV2FsbGV0LmNvbnN0cnVjdG9yIiwiUHVibGljV2FsbGV0LmJhbGFuY2UiLCJQdWJsaWNXYWxsZXQuZ2V0QWRkcmVzcyIsIlB1YmxpY1dhbGxldC5nZXRBZGRyZXNzUmFuZ2UiLCJQdWJsaWNXYWxsZXQuZ2V0QWRkcmVzc0luZm8iLCJQdWJsaWNXYWxsZXQuZ2V0VHJhbnNhY3Rpb25zIiwiUHVibGljV2FsbGV0LmdldFRyYW5zYWN0aW9ucy5jb21iaW5lIiwiUHVibGljV2FsbGV0LmdldEFkZHJlc3NlcyIsIlB1YmxpY1dhbGxldC5nZXRBZGRyZXNzZXMudGFza0NhbGxiYWNrIiwiUHVibGljV2FsbGV0LnVwZGF0ZSIsIlB1YmxpY1dhbGxldC5jcmVhdGVUcmFuc2FjdGlvbiJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSSxPQUFPLEdBQUcsT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFDO0FBQ3JDLElBQU8sS0FBSyxXQUFXLE9BQU8sQ0FBQyxDQUFDO0FBQ2hDLCtCQUE2Qiw0QkFDN0IsQ0FBQyxDQUR3RDtBQUd6RDtJQW9CRUEsc0JBQVlBLFNBQWlCQTtRQW5CN0JDLG1CQUFjQSxHQUFrQkEsSUFBSUEsK0JBQWNBLENBQUNBLGlDQUFpQ0EsQ0FBQ0EsQ0FBQ0E7UUFFdEZBLGlCQUFZQSxHQUFvQkEsRUFBRUEsQ0FBQ0E7UUFDbkNBLG9CQUFlQSxHQUFvQkEsRUFBRUEsQ0FBQ0E7UUFDdENBLHNCQUFpQkEsR0FBb0JBLEVBQUVBLENBQUNBO1FBQ3hDQSxnQkFBV0EsR0FBUUEsSUFBSUEsSUFBSUEsRUFBRUEsQ0FBQ0E7UUFlNUJBLElBQUlBLENBQUNBLFdBQVdBLEdBQUdBLElBQUlBLE9BQU9BLENBQUNBLFdBQVdBLENBQUNBLFNBQVNBLENBQUNBLENBQUNBO0lBQ3hE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